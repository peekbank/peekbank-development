---
title: "Supplemental Information"
output: pdf_document
header-includes:
  - \usepackage{threeparttablex}
  - \usepackage{booktabs}
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(here)
source(here("helper","common.R"))
```

```{r, echo=FALSE}
knitr::purl(here("paper","paper.Rmd"), documentation = 0)
suppressMessages(source(here("paper.R")))
```

# Dataset description

```{r, fig.env="figure*"}
ggplot(d_sub, aes(x = age))+ 
  geom_histogram(binwidth = 1) + 
  facet_wrap(~dataset_name, scale = "free_y")
```

```{r, fig.cap="Number of administrations for datasets with repeated measurements."}
longitudinal <- d_sub |>
  group_by(dataset_name, subject_id) |>
  count() |>
  filter(n > 1)

d_sub_long <- d_sub |>
  filter(subject_id %in% longitudinal$subject_id) |>
  group_by(subject_id) |>
  arrange(age) |>
  mutate(admin_num = 1:n(), 
         delta_t = age - age[1])

ggplot(d_sub_long, 
       aes(x = delta_t, fill = dataset_name)) +
  geom_histogram(binwidth = 1) + 
  # facet_wrap(~dataset_name) + 
  xlab("Age since first test")
```

# Speed and accuracy

Correlations between variables

```{r, results = "asis"}

cor(select(d_sub, age, log_age, rt, log_rt, 
           long_window_accuracy, short_window_accuracy, prod, comp), 
    use = "pairwise.complete.obs") |>
  round(2) |>
  papaja::apa_table()

```


```{r results="asis"}
papaja::apa_table(acc_mods_lmer_summary)
```




```{r results="asis"}
papaja::apa_table(rt_mods_lmer_summary)
```



# Exploratory Factor Analysis 

- Full EFA results

# Alternative Factor Structures

- Alternative factor models: variances together, two factor, etc. etc. 

# Non-linear Growth Models

To test for the differentiation of vocabulary growth based on initial reaction time, we used the package `nlme` to fit a logistic growth model to the production data. This model has two parameters for the logistic curve, a scale and an intercept. Both were allowed to interact with initial reaction time. We also included random effects of logistic intercept and scale by participant and a grouping term across datasets. This model showed a significant effect of initial reaction time on the intercept of the logistic growth curve, but not on its scale (see Table \ref{tab:nlme}). 

% latex table generated in R 4.4.2 by xtable 1.8-4 package
% Thu Mar 13 13:10:30 2025
\begin{table}[ht]
\centering
\begin{tabular}{rrrrrr}
  \hline
 & Value & Std Error & DF & $t$-value & $p$-value \\ 
  \hline
Growth Intercept & 2.26 & 2.70 & 1766.00 & 0.84 & 0.40 \\ 
  Growth Intercept $\times$ $t_0$ RT & 3.30 & 0.38 & 1766.00 & 8.59 & 0.00 \\ 
  Growth Scale & 2.05 & 2.60 & 1766.00 & 0.79 & 0.43 \\ 
  Growth Scale $\times$ $t_0$ RT & 0.28 & 0.38 & 1766.00 & 0.75 & 0.46 \\ 
   \hline
\end{tabular}
\caption{Fixed effects estimates from logistic growth model. \label{tab:nlme}}
\end{table}

Interpretation of growth in both this model and the linear growth model in the main text is complicated by the fact that the CDI form puts a ceiling on the total number of words that can be recorded; both the quadratic growth functions and the logistic functions come together at the form ceiling. Thus, a shift in quadratic growth in the linear model and a shift in intercept in the logistic model both point to the same overall effect, which is faster growth at the point of maximal sensitivity of the CDI. Neither model can estimate whether the overall growth trajectory is different beyond the range of the CDI. Thus, although these models might initially seem to be in conflict, we believe that they actually point to the same phenomenon, which is perhaps better described by the longitudinal SEM model reported in the main text. Children with greater skill in word recognition show an overall positive shift in the growth trajectory of vocabulary development.

```{r}
# xtable(summary(mod_nlme)$tTable)
```



# Sensitivity Analysis for Longitudinal Models

THIS IS WRONG

```{r reliability_table, results="asis"}
xtable(dataset_reliabilities)
```

Sensitivity analysis for age split point (e.g., split at 3 months)

Sensitivity analysis for measurement invariance (e.g., not constraining loadings)

# Analyses using short window accuracy

## Longitudinal factor analysis

## Longitudinal factor analysis


